{% if pagerFanta is defined %}
	{% set checkCount = pagerFanta %}
{% else %}
	{% set checkCount = projects %}
{% endif %}
{% if checkCount.nbResults > 0 %}
	<div class="container-fluid  mt-5">
		<div class="mt-3">
			<h5 class="card-title">Project List</h5>
			<div class="table-responsive">
				<table class=" table-hover table table-bordered">
					<thead>
						<tr>
							<th scope="col">Sr</th>
							<th scope="col">Project ID</th>
							<th scope="col">Project Name</th>
							{% if is_granted(constant("App\\Entity\\User::ROLE_TEAM_MANAGER")) %}
								<th scope="col">Project Manager Name</th>
							{% endif %}
							{% if is_granted('ROLE_TEAM_MANAGER') %}
								<th scope="col">Project Manager Name</th>
							{% endif %}
							<th scope="col">Description</th>
							<th scope="col">Start Date</th>
							<th scope="col">End Date</th>
							<th scope="col">Status</th>
							<th scope="col">View</th>
							<th scope="col">Report</th>
						</tr>
					</thead>
					<tbody>
						{% set count = 1 %}
						{% for project in projects %}
							<tr>
								<th scope="row">{{ count }}</th>
								<td>{{ project.id }}</td>
								<td>{{ project.Name }}</td>
								{% if is_granted(constant("App\\Entity\\User::ROLE_TEAM_MANAGER")) %}
									<td>{{ project.ProjectManager.Name }}</td>
								{% endif %}
								{% if is_granted('ROLE_TEAM_MANAGER') %}
									<td>{{ project.ProjectManager.Name }}</td>
								{% endif %}
								<td>{{ project.Description | get_small_string }}</td>
								{# <td>{{ project.smallDescription }}</td> #}
								<td>{{ project.startDate | date('d-m-y') }}</td>
								<td>{{ project.endDate | date('d-m-y') }}</td>
								<td class="{{ project.Status | project_status }} text-white">{{ project.Status }}</td>
								<td>
									{% if is_granted(constant("App\\Entity\\User::ROLE_TEAM_MANAGER")) %}
										<div class="d-flex justify-content-center">
											<a href="{{ path('show_one_project', {id: project.id}) }}">
												<button class="btn btn-success" type="submit" name="action" value="edit">
													View
												</button>
											</a>
										</div>
									{% else %}
										<div class="d-flex justify-content-around">
											<a href="{{ path('app_single_project_manage', {id: project.id}) }}">
												<button type="button" class="btn btn-success" name="action" value="edit">
													Manage Project
												</button>
											</a>
											<a href="{{ path('manage_task', {id: project.id}) }}">
												<button type="button" class="btn btn-danger">
													Manage Task
												</button>
											</a>
										</div>
									{% endif %}
								</td>
								<td data-userid={{app.user.id}} id="tdWithUserId">
									{% if find_status(project,app.User) == constant('App\\Entity\\ProjectDetails::PROJECT_REPORT_STATUS_INITIAL') or find_status(project,app.User) == constant('App\\Entity\\ProjectDetails::PROJECT_REPORT_STATUS_FAIL' ) %}
										<a type="button" href="{{ path('project_report_generator', {projectId: project.id}) }}" class="btn btn-primary">
											<i class="fa-solid fa-file-pdf"></i>
											{{find_status(project,app.User) | project_report_status}}

										</a>
									{% endif %}
									{% if find_status(project,app.User) == constant('App\\Entity\\ProjectDetails::PROJECT_REPORT_STATUS_COMPLETED') %}
										<a type="button" href="{{ path('project_report_download', {projectId: project.id}) }}" class="btn btn-primary">
											<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewbox="0 0 16 16">
												<path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
												<path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
											</svg>
											{{find_status(project,app.User) | project_report_status}}
										</a>
									{% endif %}
									{% if find_status(project,app.User) == constant('App\\Entity\\ProjectDetails::PROJECT_REPORT_STATUS_IN_PROGRESS') %}
										<a type="button" href="{{ path('show_projects') }}" class="btn btn-primary">
											<img id="globle_loader" src="{{ asset('images/in progress.gif') }}" width="20" alt="" class="animate__animated animate__fadeIn">

											{{find_status(project,app.User) | project_report_status}}
										</a>
									{% endif %}
								</td>
							</tr>
							{% set count = count + 1 %}
						{% endfor %}
					</tbody>
				</table>
			</div>
			{% if projectReport is not defined or not projectReport %}
				{{ pagerfanta(pagerFanta) }}
			{% endif %}
		</div>
	</div>
	<script src="{{ asset('js/pusher_reload_page.js') }}">
{% else %}
	<div class="alert alert-danger" role="alert">
		Oops! No projects found.
	</div>
{% endif %}
